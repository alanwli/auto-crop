<html>
<head>
  <style>
    #filedrag
    {
      display: none;
      font-weight: bold;
      text-align: center;
      padding: 2em 0;
      margin: 2em 0;
      color: #555;
      border: 3px dashed #555;
      border-radius: 20px;
      cursor: default;
    }

    #filedrag.hover
    {
      color: #f00;
      border-color: #f00;
      border-style: solid;
      box-shadow: inset 0 3px 4px #888;
    }
  </style>
</head>
<body>
  <div>
    <form id="uploadForm" action="api/auto-crop/upload" method="post" enctype="multipart/form-data">
      <div>
        <input type="file" id="fileselect" name="fileselect" accept="image/jpeg"/>
        <div id="filedrag">drag scanned file here to auto crop</div>
      </div>
      <div id="submitbutton">
        <button type="submit">upload file</button>
      </div>
    </form>
  </div>

  <script language="javascript">
    if (window.File && window.FileReader && window.FileList && window.Blob) {
      var fileselect = document.getElementById("fileselect");
      var filedrag = document.getElementById("filedrag");
      var submitbutton = document.getElementById("submitbutton");

      // file select
      //fileselect.addEventListener("change", FileSelectHandler, false);

      var xhr = new XMLHttpRequest();
      if (xhr.upload) {
        // file drop
        filedrag.addEventListener("dragover", FileDragHover, false);
        filedrag.addEventListener("dragleave", FileDragHover, false);
        filedrag.addEventListener("drop", FileSelectHandler, false);
        filedrag.style.display = "block";

        // remove submit button
        submitbutton.style.display = "none";
        fileselect.style.display = "none";
      }
    }

    // file drag hover
    function FileDragHover(e) {
      e.stopPropagation();
      e.preventDefault();
      e.target.className = (e.type == "dragover" ? "hover" : "");
    }

    function FileSelectHandler(e) {
      // cancel event and hover styling
      FileDragHover(e);
      // fetch FileList object
      var files = e.target.files || e.dataTransfer.files;
      // process all File objects
      for (var i = 0, f; f = files[i]; i++) {
        upload(f);
      }
    }

    function upload(file) {
      var formData = new FormData();
      formData.append("fileselect", file);
      var xhr = new XMLHttpRequest();
      //if (xhr.upload && file.type == "image/jpeg") {
      xhr.open("POST", document.getElementById("uploadForm").action, true);
      xhr.send(formData);
      //}
    }
  </script>
</body>
</html>
